services:
  # Backend Service
  - type: web
    name: finops-backend
    env: node
    root: backend
    buildCommand: npm install && npm run build
    startCommand: npm start
    envVars:
      - key: PORT
        value: 10000
    healthCheckPath: /api/metrics

  # Frontend Service (Static Site)
  - type: static
    name: finops-frontend
    env: static
    root: frontend
    buildCommand: npm install && npm run build
    staticPublishPath: ./dist
    envVars:
      - key: VITE_API_BASE_URL
        fromService:
          type: web
          name: finops-backend
          property: url
        # Append /api manually if needed, or update code. 
        # Current code expects VITE_API_BASE_URL to include /api? NO.
        # Check code: `${API_BASE_URL}/metrics`. 
        # If Render gives https://backend.onrender.com, we need https://backend.onrender.com/api
        # So in Render UI, user might need to append /api. 
        # Actually easier to fix code to not assume /api in env var, or just document it.
        # Let's document it.
